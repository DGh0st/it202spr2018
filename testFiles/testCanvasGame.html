<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
  </head>
  <body>
    <canvas id="myCanvas"></canvas>
    <script>
      var c=document.getElementById("myCanvas");
      var ctx=c.getContext("2d");
      ctx.fillStyle = "blue";
      
      var harm = {x: 50, y: 50, color:"red", radius: 25, direction: {x: 1, y: 1}};
      var playerMovementSpeed = 1;
      var player = {x: 100, y: 50, color:"green", radius: 25};
      var keys = [];
      
      function draw() {
        ctx.clearRect(0,0,c.width,c.height);
        
        // move players
        for (var i = 0; i < keys.length; i++) {
          if (keys[i]) {
          var key = String.fromCharCode(i);
          if (key == 'W')
            player.y -= playerMovementSpeed;
          else if (key == 'S')
            player.y += playerMovementSpeed;
          if (key == 'A')
            player.x -= playerMovementSpeed;
          else if (key == 'D')
            player.x += playerMovementSpeed;
          if (player.x < player.radius)
            player.x = player.radius;
          else if (player.x > c.width - player.radius)
            player.x = c.width - player.radius;
          if (player.y < player.radius)
            player.y = player.radius;
          else if (player.y > c.height - player.radius)
            player.y = c.height - player.radius;
          }
        }
        
        // check collision
        var dx = harm.x - player.x;
        var dy = harm.y - player.y;
        var distance = Math.sqrt((dx * dx) + (dy * dy));
        var circleDistance = harm.radius + player.radius;
        if (distance <  circleDistance) {
          harm.direction.x += dx / circleDistance;
          harm.direction.y += dy / circleDistance;
          if (harm.direction.x > 1)
            harm.direction.x = 1;
          else if (harm.direction.x < -1)
            harm.direction.x = -1;
          if (harm.direction.y > 1)
            harm.direction.y = 1;
          else if (harm.direction.x < -1)
            harm.direction.x = -1;
        }
        
        // move harm
        harm.x += harm.direction.x;
        harm.y += harm.direction.y;
        if (harm.x < harm.radius) {
          harm.direction.x = harm.x / harm.radius;
          if (harm.direction.x > 1)
            harm.direction.x = 1;
        } else if (harm.x > c.width - harm.radius) {
          harm.direction.x = (harm.x - c.width) / harm.radius;
          if (harm.direction.x < -1)
            harm.direction.x = -1;
        }
        if (harm.y < harm.radius) {
          harm.direction.y = harm.y / harm.radius;
          if (harm.direction.y > 1)
            harm.direction.y = 1;
        } else if (harm.y > c.height - harm.radius) {
          harm.direction.y = (harm.y - c.height) / harm.radius;
          if (harm.direction.y < -1)
            harm.direction.x = -1;
        }
      
        // draw harm
        ctx.fillStyle = harm.color;
        ctx.beginPath();
        ctx.arc(harm.x,harm.y,harm.radius,0,2*Math.PI);
        ctx.fill();
        
        // draw player
        ctx.fillStyle = player.color;
        ctx.beginPath();
        ctx.arc(player.x,player.y,player.radius,0,2*Math.PI);
        ctx.fill();
        
        requestAnimationFrame(draw);
      }
      
      document.addEventListener('keydown', function(event) {
        keys[event.keyCode] = true;
      });
      
      document.addEventListener('keyup', function(event) {
        keys[event.keyCode] = false;
      });
      
      draw();
    </script>
  </body>
</html>